# ุฅุตูุงุญ ูุดููุฉ ุงูุฅุฑุณุงู ุงููุฒุฏูุฌ ุฅูู Google Sheets - ุงูุญู ุงูููุงุฆู

## ุงููุดููุฉ ุงูุฃุตููุฉ

ูุงู ุงููุธุงู ูุฑุณู ุงูุทูุจ ุฅูู Google Sheets ูุฑุชูู:
1. **ุนูุฏ ุฅูุดุงุก ุงูุทูุจ** (ูู ุตูุญุฉ ุงูููุชุฌ)
2. **ุนูุฏ ุชุฃููุฏ ุงูุทูุจ** (ูู ุตูุญุฉ ุงูุฅุฏุงุฑุฉ)

## ุงูุญู ุงููุทุจู

### 1. ุฅุฒุงูุฉ ุงูุฅุฑุณุงู ูู ุตูุญุฉ ุงูููุชุฌ โ

ุชู ุงูุชุฃูุฏ ูู ุฃู ุตูุญุงุช ุงูููุชุฌุงุช ูุง ุชุญุชูู ุนูู ุฃู ุงุณุชุฏุนุงุกุงุช ูู Google Sheets API. ุงูุทูุจุงุช ุชูุญูุธ ูู Supabase ููุท ุนูุฏ ุงูุฅูุดุงุก.

### 2. ุฅุฑุณุงู ูุงุญุฏ ููุท ูู ุตูุญุฉ ุงูุฅุฏุงุฑุฉ โ

- โ ุฅุฑุณุงู ุงูุทูุจ ุฅูู Google Sheets **ููุท** ุนูุฏ `status === "confirmed"`
- โ **ุฅุฒุงูุฉ ูุงููุฉ** ูู PUT request ูุชุญุฏูุซ ุงูุญุงูุฉ
- โ ุงุณุชุฎุฏุงู `POST` ููุท ูุฅุฑุณุงู ุงูุทูุจ ุงููุงูู

### 3. ููุน ุงูุชูุฑุงุฑ ูู API โ

ุชู ุฅุถุงูุฉ ููุทู ููุน ุงูุชูุฑุงุฑ ูู `app/api/sheets/route.ts`:

#### ุฏุงูุฉ ุงูุชุญูู ูู ูุฌูุฏ ุงูุทูุจ
```typescript
async function checkOrderExists(orderId: string, orderNumber: string): Promise<boolean> {
  // ุฌูุจ ุฌููุน ุงูุจูุงูุงุช ูู Google Sheets
  // ุงูุจุญุซ ุนู ุงูุทูุจ ูู ุงูุนููุฏ B (ุฑูู ุงูุทูุจ)
  // ุฅุฑุฌุงุน true ุฅุฐุง ูุงู ุงูุทูุจ ููุฌูุฏ
}
```

#### ููุทู ููุน ุงูุชูุฑุงุฑ ูู POST
```typescript
// ุงูุชุญูู ูู ูุฌูุฏ ุงูุทูุจ ูุจู ุงูุฅุฑุณุงู
const orderExists = await checkOrderExists(order.id, finalOrderNumber)

if (orderExists) {
  return NextResponse.json({ 
    success: true, 
    message: 'ุงูุทูุจ ููุฌูุฏ ุจุงููุนู ูู Google Sheets',
    skipped: true
  });
}
```

### 4. ุชุญุณูู ูุงุฌูุฉ ุงููุณุชุฎุฏู โ

#### ุตูุญุฉ ุงูุฅุฏุงุฑุฉ
- โ ุฑุณุงุฆู ูุงุถุญุฉ ุนูุฏ ุชุฎุทู ุงูุทูุจ ุงูููุฑุฑ
- โ ุญูุงูุฉ ุถุฏ ุงูููุฑ ุงููุฒุฏูุฌ ุนูู ุฃุฒุฑุงุฑ ุงูุญุงูุฉ
- โ ุชุนุทูู ุงูุฃุฒุฑุงุฑ ุฃุซูุงุก ุงูุชุญุฏูุซ

#### ุตูุญุฉ ุงูุงุฎุชุจุงุฑ
- โ ุงุฎุชุจุงุฑ ููุน ุงูุชูุฑุงุฑ
- โ ุนุฑุถ ุงููุชุงุฆุฌ ุงูุชูุตูููุฉ
- โ ุฅููุงููุฉ ุงุฎุชุจุงุฑ ุงูุฅุฑุณุงู ุงููุฒุฏูุฌ

## ุณูุฑ ุงูุนูููุฉ ุงูุฌุฏูุฏ

### 1. ุฅูุดุงุก ุงูุทูุจ (ุตูุญุฉ ุงูููุชุฌ)
```
๐ ุฅูุดุงุก ุงูุทูุจ โ ุญูุธ ูู Supabase ููุท
โ ูุง ุฅุฑุณุงู ุฅูู Google Sheets
```

### 2. ุชุฃููุฏ ุงูุทูุจ (ุตูุญุฉ ุงูุฅุฏุงุฑุฉ)
```
๐ ุชุญุฏูุซ ุงูุญุงูุฉ ุฅูู "ูุคูุฏ"
๐ ุงูุชุญูู ูู ูุฌูุฏ ุงูุทูุจ ูู Google Sheets
โ ุฅุฑุณุงู ุฌุฏูุฏ ุฃู โ๏ธ ุชุฎุทู ุฅุฐุง ููุฌูุฏ
๐ฆ ุชุญุฏูุซ ุงููุฎุฒูู
```

## ุฑุณุงุฆู ุงูุชุชุจุน

### ุนูุฏ ุงูุฅุฑุณุงู ุงููุงุฌุญ
```
๐ ุฅุฑุณุงู ุงูุทูุจ ุงููุคูุฏ ุฅูู Google Sheets: {orderId}
โ ุชู ุฅุฑุณุงู ุงูุทูุจ ุฅูู Google Sheets ุจูุฌุงุญ
```

### ุนูุฏ ุชุฎุทู ุงูุทูุจ ุงูููุฑุฑ
```
โ๏ธ ุงูุทูุจ ููุฌูุฏ ุจุงููุนู ูู Google Sheets - ุชู ุชุฎุทู ุงูุฅุฑุณุงู
```

### ุนูุฏ ุงูุญุงูุฉ ุบูุฑ ุงููุคูุฏุฉ
```
๐ ุงูุญุงูุฉ ุบูุฑ ูุคูุฏุฉ - ูุง ูุชู ุฅุฑุณุงู ุงูุทูุจ ุฅูู Google Sheets: {status}
```

## ุงุฎุชุจุงุฑ ุงูุญู

### ุตูุญุฉ ุงูุงุฎุชุจุงุฑ ุงูุฌุฏูุฏุฉ (`/test-sheets`)
1. **ุงุฎุชุจุงุฑ ุฅุฑุณุงู ูุงุญุฏ**: ุฅุฑุณุงู ุทูุจ ุฌุฏูุฏ
2. **ุงุฎุชุจุงุฑ ููุน ุงูุชูุฑุงุฑ**: ุฅุฑุณุงู ููุณ ุงูุทูุจ ูุฑุชูู
3. **ุนุฑุถ ุงููุชุงุฆุฌ**: ุชูุงุตูู ูุงููุฉ ุนู ูู ุนูููุฉ

### ุงููุชุงุฆุฌ ุงููุชููุนุฉ
- โ ุงูุฅุฑุณุงู ุงูุฃูู: ูุฌุญ
- โ ุงูุฅุฑุณุงู ุงูุซุงูู: ุชู ุชุฎุทูู (skipped: true)
- โ ูุง ุชูุฑุงุฑ ูู Google Sheets

## ุงููููุงุช ุงููุนุฏูุฉ

### 1. `app/api/sheets/route.ts`
- โ ุฅุถุงูุฉ ุฏุงูุฉ `checkOrderExists`
- โ ููุทู ููุน ุงูุชูุฑุงุฑ ูู POST
- โ ุฑุณุงุฆู ุชุชุจุน ูุญุณูุฉ

### 2. `app/admin/page.tsx`
- โ ูุนุงูุฌุฉ ุญุงูุฉ `skipped` ูู ุงูุงุณุชุฌุงุจุฉ
- โ ุฑุณุงุฆู ูุงุถุญุฉ ูููุณุชุฎุฏู

### 3. `app/test-sheets/page.tsx`
- โ ุงุฎุชุจุงุฑ ููุน ุงูุชูุฑุงุฑ
- โ ูุงุฌูุฉ ูุญุณูุฉ ููุงุฎุชุจุงุฑ

## ุงูููุงุฆุฏ

### 1. ููุน ุงูุชูุฑุงุฑ ุงูุชููุงุฆู
- ูุง ุญุงุฌุฉ ููุชุฏุฎู ุงููุฏูู
- ุญูุงูุฉ ูู ุงูุฃุฎุทุงุก ุงูุจุดุฑูุฉ
- ุชูููุฑ ุงูููุช ูุงูุฌูุฏ

### 2. ุดูุงููุฉ ูุงููุฉ
- ุฑุณุงุฆู ูุงุถุญุฉ ูููุณุชุฎุฏู
- ุชุชุจุน ููุตู ูู Console
- ุฅููุงููุฉ ุงููุฑุงูุจุฉ ูุงูุชุตุญูุญ

### 3. ุฃุฏุงุก ูุญุณู
- ุชูููู ุงุณุชุฏุนุงุกุงุช API ุบูุฑ ุงูุถุฑูุฑูุฉ
- ุชุญุณูู ุณุฑุนุฉ ุงูุงุณุชุฌุงุจุฉ
- ุชูููู ุงูุญูู ุนูู Google Sheets

## ุงูุชุตุญูุญ

ุฅุฐุง ูุงุฌูุช ุฃู ูุดุงูู:

1. **ุฑุงุฌุน Console**: ุชุญูู ูู ุฑุณุงุฆู ุงูุชุชุจุน
2. **ุงุฎุชุจุฑ API**: ุงุณุชุฎุฏู ุตูุญุฉ `/test-sheets`
3. **ุชุญูู ูู Google Sheets**: ุชุฃูุฏ ูู ุนุฏู ูุฌูุฏ ุชูุฑุงุฑ
4. **ุฃุนุฏ ุชุดุบูู ุงูุฎุงุฏู**: `npm run dev`

## ููุฎุต ุงูุฅุตูุงุญ

- **ูุจู**: ุฅุฑุณุงู ูุฒุฏูุฌ โ ุชูุฑุงุฑ ูู Google Sheets
- **ุจุนุฏ**: ุฅุฑุณุงู ูุงุญุฏ + ููุน ุงูุชูุฑุงุฑ โ ุญู ููุงุฆู โ

**ุงููุชูุฌุฉ**: ูุธุงู ุขูู ูููุซูู ูุฅุฑุณุงู ุงูุทูุจุงุช ุฅูู Google Sheets ุจุฏูู ุชูุฑุงุฑ. 